;; Kanata Configuration for VS Code Power User
;; Features: Space-Hold Nav Layer, Blank Line Jumps, Call Hierarchy, and Copy Path

(defsrc
  grv  1    2    3    4    5    6    7    8    9    0    -    =    bspc
  tab  q    w    e    r    t    y    u    i    o    p    [    ]    \
  caps a    s    d    f    g    h    j    k    l    ;    '    ret
  lsft z    x    c    v    b    n    m    ,    .    /    rsft
  lctl lmet lalt            spc            ralt rmet rctl
)

(deftemplate text-paste (text)
 (macro
  (clipboard-save 0)
  (clipboard-set $text)
  C-v
  200
  (clipboard-restore 0)
 ))

(defalias
  ;; --- NAVIGATION MACROS ---
  vim_o (macro end ret)
  call_h S-A-h    
  pk_ref S-f12    

  ;; Paragraph/Blank Line Navigation
  blnk_up C-S-[ 
  blnk_dn C-S-]

  ;; Smart Selection
  sel_i S-A-right  
  sel_o S-A-left   

  ;; --- FILE VSCODE NAVIGATION ---
  qk_op C-p        
  go_ln C-g        
  nav_bk A-left    
  nav_fw A-right   
  go_top C-home    
  go_bot C-end     
  go_def f12       
  
  ;; NEW: Copy Path Chord
  cp_pth (macro C-k C-S-c)

  ;; --- SEARCH TAP DANCE ---
  f_dns (tap-dance 200 (
    (multi lctl lsft f)
    (macro C-S-e C-A-f)
  ))

  ;; --- CORE FUNCTIONS ---
  rel lrld  
  sp_v (tap-hold-release 200 200 spc (layer-toggle vscode_nav))
  shrug (t! text-paste "¯\_(ツ)_/¯")
)

(deflayer base
  grv  1    2    3    4    5    6    7    8    9    0    -    =    bspc
  tab  q    w    e    r    t    y    u    i    o    p    [    ]    \
  caps a    s    d    f    g    h    j    k    l    ;    '    ret
  lsft z    x    c    v    b    n    m    ,    .    /    rsft
  lctl lmet lalt            @sp_v           ralt rmet rctl
)

  ;; ╔═══════════════════════════════════════════════════════════════════════════════════════════╗
  ;; ║                                VSCODE_NAV LAYER LAYOUT                                    ║
  ;; ║                               (Hold Space to activate)                                    ║
  ;; ╠═══════════════════════════════════════════════════════════════════════════════════════════╣
  ;; ║                                                                                             ║
  ;; ║  ┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐    ║
  ;; ║  │     │ CALL│ PEEK│     │     │     │     │     │     │     │SHRUG│     │     │     │    ║
  ;; ║  │ (`) │HIER │ REF │ (3) │ (4) │ (5) │ (6) │ (7) │ (8) │ (9) │ ¯\_ │ (-) │ (=) │BKSP │    ║
  ;; ║  │     │ (1) │ (2) │     │     │     │     │     │     │     │ (0) │     │     │     │    ║
  ;; ║  ├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┤    ║
  ;; ║  │     │BLANK│BLANK│     │     │     │GO TO│FILE │FILE │ VIM │QUICK│     │     │     │    ║
  ;; ║  │(TAB)│  ↑  │  ↓  │ (E) │ (R) │ (T) │ DEF │ TOP │ END │  O  │OPEN │ ([) │ (]) │ (\) │    ║
  ;; ║  │     │ (Q) │ (W) │     │     │     │ (Y) │ (U) │ (I) │ (O) │ (P) │     │     │     │    ║
  ;; ║  ├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┤    ║
  ;; ║  │     │ SEL │ SEL │     │SRCH │ GO  │     │     │     │     │     │     │     │           ║
  ;; ║  │CAPS │SHRNK│ EXP │ (D) │ TAP │LINE │ (H) │ (J) │ (K) │ (L) │ (;) │ (') │ ENTER       │  ║
  ;; ║  │     │ (A) │ (S) │     │ (F) │ (G) │     │     │     │     │     │     │             │  ║
  ;; ║  ├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┴─────────────┤  ║
  ;; ║  │     │ NAV │ NAV │ COPY│     │     │     │     │     │     │     │                   │  ║
  ;; ║  │SHIFT│  ←  │  →  │ PATH│ (V) │ (B) │ (N) │ (M) │ (,) │ (.) │ (/) │      RSHIFT       │  ║
  ;; ║  │     │ (Z) │ (X) │ (C) │     │     │     │     │     │     │     │                   │  ║
  ;; ║  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴───────────────────┘  ║
  ;; ║        ┌─────┬─────┬─────┐              ┌─────┐              ┌─────┬─────┬─────┐            ║
  ;; ║        │     │     │     │              │[HOLD│              │     │     │RLOAD│            ║
  ;; ║        │CTRL │ WIN │ ALT │              │SPACE│              │RALT │RWIN │ CFG │            ║
  ;; ║        └─────┴─────┴─────┘              └─────┘              └─────┴─────┴─────┘            ║
  ;; ╚═══════════════════════════════════════════════════════════════════════════════════════════╝
(deflayer vscode_nav
  _    @call_h @pk_ref _      _      _      _       _       _       _       @shrug _    _    _
  _    @blnk_up @blnk_dn _    _      _      @go_def @go_top @go_bot @vim_o @qk_op _    _    _
  _    @sel_o @sel_i _        @f_dns @go_ln _       _       _       _       _      _    _
  _    @nav_bk @nav_fw @cp_pth _      _      _       _       _       _       _      _
  _    _    _                 _                     _       _       @rel
)